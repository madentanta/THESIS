<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Hasil Rekomendasi - PlantAdvisor</title>

    <link rel="stylesheet" href="style.css" /> 
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">


    <style>
        body {
            background-color: #f3f4f6;
            font-family: 'Inter', sans-serif;
            color: #1e293b;
            margin: 0;
            padding: 0;
        }

        .card-tanaman { display: none; } /* Disembunyikan untuk dipanggil JS */

        .container-detail {
            max-width: 850px;
            margin: 40px auto;
            padding: 20px;
        }

        .content-box {
            background: #fff;
            border-radius: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            padding: 40px;
            margin-bottom: 30px;
            border: 1px solid #eee;
        }

        .plant-header {
            display: flex;
            align-items: center;
            gap: 25px;
            margin-bottom: 30px;
        }

        .plant-image {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: 20px;
            background: #f0f0f0;
        }

        .plant-header h3 {
            font-size: 28px;
            font-weight: 800;
            margin: 0;
            color: #1a365d;
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            margin: 35px 0 20px;
            color: #334155;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Styling Step 1-5 */
        .step {
            background: #f8fafc;
            border-radius: 18px;
            padding: 20px 25px;
            margin-bottom: 15px;
            display: flex;
            gap: 20px;
            border-left: 6px solid hsl(68, 84%, 28%);
            transition: transform 0.2s ease;
        }

        .step:hover {
            transform: translateX(5px);
        }

        .step-number {
            background: hsl(68, 84%, 28%);
            color: #fff;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            flex-shrink: 0;
            font-size: 14px;
            box-shadow: 0 4px 10px rgba(192, 214, 51, 0.3);
        }

        .step-content h5 {
            margin: 0 0 8px 0;
            font-size: 18px;
            font-weight: 700;
            color: #1e293b;
        }

        .steps-list {
            list-style: none;
            padding: 0;
            margin: 0 !important;
        }

        .steps-list li {
            position: relative;
            padding-left: 25px;
            font-size: 14.5px;
            color: #475569;
            line-height: 1.6;
            margin-bottom: 8px;
        }

        .steps-list li::before {
            content: "üå±";
            position: absolute;
            left: 0;
            font-size: 12px;
            top: 3px;
        }

        .action-buttons {
            text-align: center;
            margin-top: 50px;
        }

        .btn-large {
            padding: 18px 50px;
            background-color: hsl(68, 84%, 28%);
            color: #fff;
            border-radius: 15px;
            font-weight: 700;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            border: none;
            box-shadow: 0 6px 20px rgba(192, 214, 51, 0.4);
            cursor: pointer;
        }

        .analysis-box {
            background: #f9fbe7;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            border-left: 4px solid hsl(68, 84%, 28%);
            font-size: 14px;
            line-height: 1.6;
        }
    </style>
</head>

<body>
<header class="main-header">
    <div class="logo">PlantAdvisor</div>
    <nav class="main-nav">
        <a href="beranda.html">Beranda</a>
    </nav>
    <div class="header-buttons" id="headerButtons"></div>
</header>
<main class="container-detail">
    <h2 class="page-title" style="font-weight: 800; margin-bottom: 30px;">
        <a href="beranda.html" style="text-decoration: none; color: #334155;">&lt;</a> Hasil Rekomendasi
    </h2>

    <div id="loading-state" class="content-box" style="text-align: center;">
        <p>‚öôÔ∏è <b>Menganalisis data tanah...</b></p>
    </div>

    <div id="result-wrapper"></div>

    <div id="tpl-padi" class="card-tanaman content-box">
        <div class="plant-header">
            <img src="padi.png" class="plant-image" alt="Padi"/>
            <h3>Tanaman Padi <span class="latin-name">(Oryza sativa)</span></h3>

        </div>
        <h4 class="section-title">üåæ Panduan Budidaya - Panen</h4>

        <div class="step">
            <div class="step-number">1</div>
            <div class="step-content">
                <h5>Pemilihan Benih</h5>
                <ul class="steps-list">
                    <li>Gunakan benih unggul bersertifikat (Inpari, IR64).</li>
                    <li>Rendam benih di air garam, buang yang mengapung.</li>
                </ul>
            </div>
        </div>
        <div class="step">
            <div class="step-number">2</div>
            <div class="step-content">
                <h5>Penyemaian</h5>
                <ul class="steps-list">
                    <li>Rendam benih 24 jam dan inkubasi selama 48 jam.</li>
                    <li>Semai di bedengan selama 18-22 hari.</li>
                </ul>
            </div>
        </div>
        <div class="step">
            <div class="step-number">3</div>
            <div class="step-content">
                <h5>Penanaman</h5>
                <ul class="steps-list">
                    <li>Pindah tanam bibit dengan kedalaman 2-3 cm.</li>
                    <li>Gunakan sistem Jajar Legowo untuk hasil optimal.</li>
                </ul>
            </div>
        </div>
        <div class="step">
            <div class="step-number">4</div>
            <div class="step-content">
                <h5>Pemeliharaan</h5>
                <ul class="steps-list">
                    <li>Pupuk NPK pada hari ke-15 dan ke-35.</li>
                    <li>Jaga ketinggian air dan bersihkan gulma secara rutin.</li>
                </ul>
            </div>
        </div>
        <div class="step">
            <div class="step-number">5</div>
            <div class="step-content">
                <h5>Panen</h5>
                <ul class="steps-list">
                    <li>Panen saat 95% malai padi sudah menguning merata.</li>
                    <li>Potong pangkal malai dan segera lakukan perontokan.</li>
                </ul>
            </div>
        </div>
    </div>

    <div id="tpl-jagung" class="card-tanaman content-box">
        <div class="plant-header">
            <img src="jagung.jpeg" class="plant-image" alt="Jagung"/>
            <h3>Tanaman Jagung <span class="latin-name">(Zea mays)</span></h3>

        </div>
        <h4 class="section-title">üåΩ Panduan Budidaya - Panen</h4>

        <div class="step">
            <div class="step-number">1</div>
            <div class="step-content">
                <h5>Pemilihan Benih</h5>
                <ul class="steps-list">
                    <li>Pilih varietas hibrida tahan penyakit bulai.</li>
                    <li>Pastikan benih memiliki persentase tumbuh >90%.</li>
                </ul>
            </div>
        </div>
        <div class="step">
            <div class="step-number">2</div>
            <div class="step-content">
                <h5>Penyemaian</h5>
                <ul class="steps-list">
                    <li>Tanam langsung di lahan atau gunakan tray semai.</li>
                    <li>Pastikan media semai kaya akan nutrisi organik.</li>
                </ul>
            </div>
        </div>
        <div class="step">
            <div class="step-number">3</div>
            <div class="step-content">
                <h5>Penanaman</h5>
                <ul class="steps-list">
                    <li>Tanam sedalam 5cm dengan jarak tanam 75x20 cm.</li>
                    <li>Isi satu lubang tanam dengan satu benih jagung.</li>
                </ul>
            </div>
        </div>
        <div class="step">
            <div class="step-number">4</div>
            <div class="step-content">
                <h5>Pemeliharaan</h5>
                <ul class="steps-list">
                    <li>Lakukan pembumbunan tanah pada pangkal batang.</li>
                    <li>Berikan pupuk Urea/NPK agar batang kokoh.</li>
                </ul>
            </div>
        </div>
        <div class="step">
            <div class="step-number">5</div>
            <div class="step-content">
                <h5>Panen</h5>
                <ul class="steps-list">
                    <li>Panen saat klobot mengering dan biji terasa keras.</li>
                    <li>Pastikan muncul titik hitam (black layer) di biji.</li>
                </ul>
            </div>
        </div>
    </div>

    <div id="tpl-tebu" class="card-tanaman content-box">
        <div class="plant-header">
            <img src="tebu.png" class="plant-image" alt="Tebu"/>
            <h3>Tanaman Tebu <span class="latin-name">(Saccharum officinarum)</span></h3>

        </div>
        <h4 class="section-title">üéã Panduan Budidaya - Panen</h4>

        <div class="step">
            <div class="step-number">1</div>
            <div class="step-content">
                <h5>Pemilihan Benih</h5>
                <ul class="steps-list">
                    <li>Gunakan bibit stek dari batang muda (6-8 bulan).</li>
                    <li>Pilih stek yang memiliki 2-3 mata tunas aktif.</li>
                </ul>
            </div>
        </div>
        <div class="step">
            <div class="step-number">2</div>
            <div class="step-content">
                <h5>Penyemaian</h5>
                <ul class="steps-list">
                    <li>Semai stek di bedengan datar secara bersambung.</li>
                    <li>Lakukan penyiraman rutin hingga tunas muncul merata.</li>
                </ul>
            </div>
        </div>
        <div class="step">
            <div class="step-number">3</div>
            <div class="step-content">
                <h5>Penanaman</h5>
                <ul class="steps-list">
                    <li>Pindahkan ke juringan sedalam 25 cm.</li>
                    <li>Tutup stek dengan tanah tipis agar tunas mudah keluar.</li>
                </ul>
            </div>
        </div>
        <div class="step">
            <div class="step-number">4</div>
            <div class="step-content">
                <h5>Pemeliharaan</h5>
                <ul class="steps-list">
                    <li>Lakukan klentek (pembuangan daun kering) berkala.</li>
                    <li>Waspadai hama penggerek batang dan penyakit karat.</li>
                </ul>
            </div>
        </div>
        <div class="step">
            <div class="step-number">5</div>
            <div class="step-content">
                <h5>Panen</h5>
                <ul class="steps-list">
                    <li>Tebang tebu saat rendemen gula mencapai maksimal.</li>
                    <li>Potong serapat mungkin dengan tanah (pangkal manis).</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="action-buttons">
        <a href="beranda.html" class="btn-large">Selesai / Kembali ke Beranda</a>
    </div>
</main>

<script>
    const API_BASE_URL = "http://plantadvisor.cloud/api";

    document.addEventListener("DOMContentLoaded", () => {
        fetchRecommendation();
    });

    async function fetchRecommendation() {
        const inputId = localStorage.getItem("input_id");
        if (!inputId) return;

        try {
            const res = await fetch(`${API_BASE_URL}/recommendation/${inputId}`);
            const result = await res.json();
            
            document.getElementById("loading-state").style.display = "none";
            
            if (res.ok && result.recommendations) {
                renderCards(result.recommendations);
            }
        } catch (e) { console.error(e); }
    }

    function renderCards(data) {
        const wrapper = document.getElementById("result-wrapper");
        wrapper.innerHTML = "";
        
        data.forEach(item => {
            const name = item.nama_tanaman.toLowerCase();
            let id = name.includes("padi") ? "tpl-padi" :
                     name.includes("tebu") ? "tpl-tebu" : 
                     name.includes("jagung") ? "tpl-jagung" : null;
            
            if (!id) return;

            const clone = document.getElementById(id).cloneNode(true);
            clone.removeAttribute("id");
            clone.style.display = "block";

            // Tambahkan Box Analisis dari Database
            const analysis = document.createElement("div");
            analysis.className = "analysis-box";
            analysis.innerHTML = `<b>Ensiklopedia</b><br>${item.care_instructions.replace(/\n/g,"<br>")}`;

            clone.insertBefore(analysis, clone.querySelector(".section-title"));
            wrapper.appendChild(clone);
        });
    }
</script>
</body>
</html>